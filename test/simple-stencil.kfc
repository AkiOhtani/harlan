;; -*- scheme -*-
(%testspec xfail)

(module
  (extern rotate_4_int_vec ((vec 4 int) int) -> (vector 4 int))
  (define (main)
      (let X (vector 1 2 3 4))
      ;; TODO: we should be able to inline this in kernel args.
      (let X2 (rotate_4_int_vec X 1))
      (let X (kernel ((x X) (y X2)) (+ x y)))
      (assert (= (vector-ref X 0) 5))
      (assert (= (vector-ref X 1) 3))
      (assert (= (vector-ref X 2) 5))
      (assert (= (vector-ref X 3) 7))
      (return 0)))
