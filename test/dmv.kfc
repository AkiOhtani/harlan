;; Dense matrix-vector product

(module
  (define (main)
    (let ((M (vector
              (vector 1 0 0 0)
              (vector 0 1 0 0)
              (vector 0 0 1 0)
              (vector 0 0 0 1)))
          (X (vector 1 2 3 4)))
      (let ((Y (kernel ((row M))
                 (reduce + (kernel ((x X) (y row))
                             (* x y))))))
        (assert (= X Y))
        (return 0)))))
