;; -*- scheme -*-

;; A part of ense matrix-matrix product
;; use loops instead of nested kernels

(module
  (define (main)
    (let ((B (vector
               (vector 1 0)
               (vector 0 1)))
          (Bt (make-vector 2 (make-vector 2 0))))
      (print B)
      (print "\n")
      (for (j 0 (length (vector-ref B 0)))
        (let ((io (iota 2)))
          (let ((row (kernel ((i io))
                       (vector-ref (vector-ref B j) i))))
            (vector-set! Bt j row))))
      (print Bt)
      (print "\n")
      (return 0))))

